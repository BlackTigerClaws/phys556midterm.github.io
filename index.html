<!DOCTYPE html>
<html>
    <head>
        <title>PHYS556 Midterm Exam (Jordan Drake)</title>
        <script src="https://www.desmos.com/api/v1.10/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
    </head>
    <body>
        <h1>PHYS556 Midterm Exam: Jordan Drake</h1>
        <select>
            <option>--select problem--</option>
            <option>Problem 1: Shell Effects</option>
            <option>Problem 2: Geiger-Nuttal Law</option>
            <option>Problem 3: Fermi Decay</option>
        </select>
        <div id="calculator" style="width: 600px; height: 400px;"></div>
        Credit to <a href="https://github.com/GoodmanSciences">Goodman Sciences</a> on GitHub for the <code>.csv</code> file of element names and symbols:
        <a href="https://gist.github.com/GoodmanSciences/c2dd862cd38f21b0ad36b8f96b4bf1ee">https://gist.github.com/GoodmanSciences/c2dd862cd38f21b0ad36b8f96b4bf1ee</a>
        <script>
            function objFilter(obj, pred) {
                const arr = Object.entries(obj).filter( ent => pred(ent[1]) );
                return arr.map( elt => elt[1] );
            }
            function objMap(obj, mapper) {
                const arr = Object.entries(obj).map( ent => [ ent[0], mapper(ent[1]) ] );
                return arr.map( elt => elt[1] );
            }
            
            // Problem 1
            
            // Problem 2
            function alphaEmitter(nuclide) {
                const elem = {};
                if ( nuclide.hasOwnProperty('levels') && nuclide.hasOwnProperty('alpha') ) {
                    const levels = nuclide['levels'];
                    if ( levels.hasOwnProperty('halflife') && levels.hasOwnProperty('decayModes') ) {
                        elem['name']     = nuclide['name'];
                        const halflife   = nuclide['levels'][0]['halflife'];
                        const decayMode  = nuclide['decayModes'].find( a => a['mode'] === 'A' );
                        elem['halflife'] = ( halflife['unit'] === 's' ? halflife['value'] :
                                             halflife['unit'] === 'm' ? halflife['value'] * 60 :
                                             halflife['unit'] === 'h' ? halflife['value'] * 3600 :
                                             halflife['unit'] === 'd' ? halflife['value'] * 86400 :
                                             halflife['unit'] === 'y' ? halflife['value'] * 31536000 :
                                             halflife['unit'] === 'ms' ? halflife['value'] / 1000 :
                                             halflife['unit'] === 'us' ? halflife['value'] / 1000000 :
                                             halflife['unit'] === 'ns' ? halflife['value'] / 1000000000 :
                                             undefined ) * 100 / decayMode['value'];
                        elem['energy']   = nuclide.alpha['unit'] === 'keV' ? nuclide.alpha['value'] :
                                           nuclide.alpha['unit'] === 'MeV' ? nuclide.alpha['value'] * 1000 :
                                           undefined;
                        if ( elem['halflife'] === undefined || elem['energy'] === undefined )
                            return undefined;
                    } else
                        return undefined;
                } else
                    return undefined;
                return elem;
            }
            async function getNuclides( filename ) {
                try {
                    const allNuclides   = await fetch(filename);
                    if (allNuclides.ok)
                        console.log("we gucci");
                    else
                        console.lot("definitiely NOT gucci");
                    const allNuclidesJS = await allNuclides.json();
                    return await objFilter(allNuclidesJS,nuclide => nuclide['z'] > 110);
                } catch (error) {
                    console.log(error);
                    return undefined;
                }
            }
            const nuclides = getNuclides("https://raw.githubusercontent.com/BlackTigerClaws/phys556midterm.github.io/f6dda05a459b28fe3cbce8cc5f7dee48e7d433c9/nndc_nudat_data_export.json");
            alphaEmiters = objFilter( objMap(nuclides, alphaEmitter), el => !(el === undefined) );

            

            // Problem 3

            // Page setup
            const calculator = Desmos.GraphingCalculator(document.getElementById('calculator'),
                                                        {border: false, allowUndo: false, zoomButtons: false, keypad: false, administerSecretFolders: false, xAxisLabel: 'E', yAxisLabel: '\\log t_{1/2}'});
        </script>
    </body>
</html>
